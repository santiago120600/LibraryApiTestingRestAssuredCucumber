{
    "port": 5555,
    "protocol": "http",
    "name": "Library API",
    "recordRequests": true,
    "stubs": [
        {
            "responses": [
                {
                    "is": {
                        "statusCode": 201,
                        "body": {
                            "status": "success",
                            "message": "Book added successfully",
                            "data": {
                                "id": 1,
                                "title": "${title}",
                                "isbn": "${isbn}",
                                "aisle_number": "${aisle_number}",
                                "author": {
                                    "id": "${author_id}",
                                    "first_name": "Ernest",
                                    "last_name": "Hemingway"
                                }
                            }
                        },
                        "headers": {
                            "Content-Type": "application/json"
                        }
                    },
                    "behaviors": [
                        {
                            "copy": {
                                "from": "body",
                                "into": "${title}",
                                "using": {
                                    "method": "jsonpath",
                                    "selector": "$.title"
                                }
                            }
                        },
                        {
                            "copy": {
                                "from": "body",
                                "into": "${isbn}",
                                "using": {
                                    "method": "jsonpath",
                                    "selector": "$.isbn"
                                }
                            }
                        },
                        {
                            "copy": {
                                "from": "body",
                                "into": "${aisle_number}",
                                "using": {
                                    "method": "jsonpath",
                                    "selector": "$.aisle_number"
                                }
                            }
                        },
                        {
                            "copy": {
                                "from": "body",
                                "into": "${author_id}",
                                "using": {
                                    "method": "jsonpath",
                                    "selector": "$.author_id"
                                }
                            }
                        },
                        {
                            "shellTransform": "node replace_string.js"
                        }
                    ]
                }
            ],
            "predicates": [
                {
                    "equals": {
                        "method": "POST",
                        "path": "/book",
                        "headers": {
                            "Content-Type": "application/json"
                        }
                    },
                    "exists": {
                        "body": {
                            "title": true,
                            "isbn": true,
                            "aisle_number": true,
                            "author_id": true
                        }
                    }
                }
            ]
        },
        {
            "responses": [
                {
                    "is": {
                        "statusCode": 200,
                        "body": {
                            "status": "success",
                            "message": "Book updated successfully",
                            "data": {
                                "id": 1,
                                "title": "${title}",
                                "isbn": "${isbn}",
                                "aisle_number": "${aisle_number}",
                                "author": {
                                    "id": "${author_id}",
                                    "first_name": "Ernest",
                                    "last_name": "Hemingway"
                                }
                            }
                        },
                        "headers": {
                            "Content-Type": "application/json"
                        }
                    },
                    "behaviors": [
                        {
                            "copy": {
                                "from": "body",
                                "into": "${title}",
                                "using": {
                                    "method": "jsonpath",
                                    "selector": "$.title"
                                }
                            }
                        },
                        {
                            "copy": {
                                "from": "body",
                                "into": "${isbn}",
                                "using": {
                                    "method": "jsonpath",
                                    "selector": "$.isbn"
                                }
                            }
                        },
                        {
                            "copy": {
                                "from": "body",
                                "into": "${aisle_number}",
                                "using": {
                                    "method": "jsonpath",
                                    "selector": "$.aisle_number"
                                }
                            }
                        },
                        {
                            "copy": {
                                "from": "body",
                                "into": "${author_id}",
                                "using": {
                                    "method": "jsonpath",
                                    "selector": "$.author_id"
                                }
                            }
                        },
                        {
                            "shellTransform": "node replace_string.js"
                        }
                    ]
                }
            ],
            "predicates": [
                {
                    "matches": {
                        "method": "PUT",
                        "path": "/book/\\d+",
                        "headers": {
                            "Content-Type": "application/json"
                        },
                        "body": {
                            "title": "The Old Man and the Sea",
                            "aisle_number": 2,
                            "isbn": "9781476787855",
                            "author_id": 1
                        }
                    }
                }
            ]
        },
        {
            "responses": [
                {
                    "is": {
                        "statusCode": 200,
                        "body": {
                            "status": "success",
                            "message": "Book deleted successfully",
                            "data": {}
                        },
                        "headers": {
                            "Content-Type": "application/json"
                        }
                    }
                }
            ],
            "predicates": [
                {
                    "equals": {
                        "method": "DELETE",
                        "path": "/book/1"
                    }
                }
            ]
        },
        {
            "responses": [
                {
                    "is": {
                        "statusCode": 200,
                        "body": {
                            "status": "success",
                            "message": "Book retrieved successfully",
                            "data": {
                                "id": 1,
                                "title": "The Old Man and the Sea",
                                "isbn": "9781476787855",
                                "aisle_number": 2,
                                "author": {
                                    "id": 1,
                                    "first_name": "Ernest",
                                    "last_name": "Hemingway"
                                }
                            }
                        },
                        "headers": {
                            "Content-Type": "application/json"
                        }
                    }
                }
            ],
            "predicates": [
                {
                    "equals": {
                        "method": "GET",
                        "path": "/book/1"
                    }
                }
            ]
        },
        {
            "responses": [
                {
                    "is": {
                        "statusCode": 201,
                        "body": {
                            "status": "success",
                            "message": "Author added successfully",
                            "data": {
                                "id": 1,
                                "first_name": "${first_name}",
                                "last_name": "${last_name}"
                            }
                        },
                        "headers": {
                            "Content-Type": "application/json"
                        }
                    },
                    "behaviors": [
                        {
                            "copy": {
                                "from": "body",
                                "into": "${first_name}",
                                "using": {
                                    "method": "jsonpath",
                                    "selector": "$.first_name"
                                }
                            }
                        },
                        {
                            "copy": {
                                "from": "body",
                                "into": "${last_name}",
                                "using": {
                                    "method": "jsonpath",
                                    "selector": "$.last_name"
                                }
                            }
                        }
                    ]
                }
            ],
            "predicates": [
                {
                    "equals": {
                        "method": "POST",
                        "path": "/author",
                        "headers": {
                            "Content-Type": "application/json"
                        }
                    },
                    "exists": {
                        "body": {
                            "first_name": true,
                            "last_name": true
                        }
                    }
                }
            ]
        },
        {
            "responses": [
                {
                    "is": {
                        "statusCode": 200,
                        "body": {
                            "status": "success",
                            "message": "Author updated successfully",
                            "data": {
                                "id": 1,
                                "first_name": "${first_name}",
                                "last_name": "${last_name}"
                            }
                        },
                        "headers": {
                            "Content-Type": "application/json"
                        }
                    },
                    "behaviors": [
                        {
                            "copy": {
                                "from": "body",
                                "into": "${first_name}",
                                "using": {
                                    "method": "jsonpath",
                                    "selector": "$.first_name"
                                }
                            }
                        },
                        {
                            "copy": {
                                "from": "body",
                                "into": "${last_name}",
                                "using": {
                                    "method": "jsonpath",
                                    "selector": "$.last_name"
                                }
                            }
                        },
                        {
                            "shellTransform": "node replace_string.js"
                        }
                    ]
                }
            ],
            "predicates": [
                {
                    "matches": {
                        "method": "PUT",
                        "path": "/author/\\d+",
                        "headers": {
                            "Content-Type": "application/json"
                        }
                    },
                     "exists": {
                        "body": {
                            "first_name": true,
                            "last_name": true
                        }
                    }
                }
            ]
        },
        {
            "responses": [
                {
                    "is": {
                        "statusCode": 200,
                        "body": {
                            "status": "success",
                            "message": "Author deleted successfully",
                            "data": {}
                        },
                        "headers": {
                            "Content-Type": "application/json"
                        }
                    }
                }
            ],
            "predicates": [
                {
                    "equals": {
                        "method": "DELETE",
                        "path": "/author/1"
                    }
                }
            ]
        },
        {
            "responses": [
                {
                    "is": {
                        "statusCode": 200,
                        "body": {
                            "status": "success",
                            "message": "Author retrieved successfully",
                            "data": {
                                "id": 1,
                                "first_name": "Herman",
                                "last_name": "Melville"
                            }
                        },
                        "headers": {
                            "Content-Type": "application/json"
                        }
                    }
                }
            ],
            "predicates": [
                {
                    "equals": {
                        "method": "GET",
                        "path": "/author/1"
                    }
                }
            ]
        }
    ]
}